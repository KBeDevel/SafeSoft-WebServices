<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Documentación / SHA-256</title>
    <link rel="shortcut icon" href="../SafeSoft.svg">
    <!-- Bootstrap styles -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!-- Custom styles -->
    <link rel="stylesheet" type="text/css" href="../res/css/docs.css"
</head>
<body>
    <section class="container-fluid">
        <div class="row">
            <div class="col">
                <h1>Hashing de cadenas de texto/bytes a SHA-256</h1>
                <p>Wiki de <a href="https://es.wikipedia.org/wiki/SHA-256">SHA-256</a></p>
                <hr>
                <h3>C#:</h3>
                <code>
                    <pre>
    
    using System;  
    using System.Text;  
    using System.Security.Cryptography;  
        
    namespace HashConsoleApp  
    {  
        class Program  
        {  
            static void Main(string[] args)  
            {  
                string plainData = "Mahesh";  
                Console.WriteLine("Raw data: {0}", plainData);  
                string hashedData = ComputeSha256Hash(plainData);  
                Console.WriteLine("Hash {0}", hashedData);  
                Console.WriteLine(ComputeSha256Hash("Mahesh"));  
                Console.ReadLine();  
            }  
        
            static string ComputeSha256Hash(string rawData)  
            {  
                // Create a SHA256   
                using (SHA256 sha256Hash = SHA256.Create())  
                {  
                    // ComputeHash - returns byte array  
                    byte[] bytes = sha256Hash.ComputeHash(Encoding.UTF8.GetBytes(rawData));  
        
                    // Convert byte array to a string   
                    StringBuilder builder = new StringBuilder();  
                    for (int i = 0; i < bytes.Length; i++)  
                    {  
                        builder.Append(bytes[i].ToString("x2"));  
                    }  
                    return builder.ToString();  
                }  
            }  
                        
        }  
        
    }  

                    </pre>
                </code>
                <h3>Java:</h3>
                <code>
                    <pre>

    import java.security.MessageDigest;
    import java.util.Scanner;
    import javax.xml.bind.DatatypeConverter;
    
    /**
    * Demonstrates how to generate SHA256 hash in Java
    * @author JJ
    */
    public class SHA256InJava {
    
        public static void main(String[] args) {
            Scanner sn = new Scanner(System.in);
            System.out.print("Please enter data for which SHA256 is required:");
            String data = sn.nextLine();
            
            SHA256InJava sj = new SHA256InJava();
            String hash = sj.getSHA256Hash(data);
            System.out.println("The SHA256 (hexadecimal encoded) hash is:"+hash);
        }
    
        /**
        * Returns a hexadecimal encoded SHA-256 hash for the input String.
        * @param data
        * @return 
        */
        private String getSHA256Hash(String data) {
            String result = null;
            try {
                MessageDigest digest = MessageDigest.getInstance("SHA-256");
                byte[] hash = digest.digest(data.getBytes("UTF-8"));
                return bytesToHex(hash); // make it printable
            }catch(Exception ex) {
                ex.printStackTrace();
            }
            return result;
        }
        
        /**
        * Use javax.xml.bind.DatatypeConverter class in JDK to convert byte array
        * to a hexadecimal string. Note that this generates hexadecimal in upper case.
        * @param hash
        * @return 
        */
        private String  bytesToHex(byte[] hash) {
            return DatatypeConverter.printHexBinary(hash);
        }
    }

                    </pre>
                </code>
                <h3>PHP</h3>
                <code>
                    <pre>

    $rawString = "something";

    $hashedString = hash('sha256', $rawString);

    echo $hashedString;

                    </pre>
                </code>
                <h3>JavaScript / TypeScript</h3>
                <code>
                    <pre>
                        
    var rawString = "something"

    console.log(string2SHA256(rawString))

    function string2SHA256(s){
        var chrsz = 8;
        var hexcase = 0;
        
        function safe_add (x, y) {
            var lsw = (x & 0xFFFF) + (y & 0xFFFF)
            var msw = (x >> 16) + (y >> 16) + (lsw >> 16)
            return (msw << 16) | (lsw & 0xFFFF)
        }
        
        function S (X, n) { 
            return ( X >>> n ) | (X << (32 - n))
        }
    
        function R (X, n) { 
            return ( X >>> n )
        }
    
        function Ch(x, y, z) { 
            return ((x & y) ^ ((~x) & z))
        }
    
        function Maj(x, y, z) { 
            return ((x & y) ^ (x & z) ^ (y & z))
        }
    
        function Sigma0256(x) { 
            return (S(x, 2) ^ S(x, 13) ^ S(x, 22))
        }
    
        function Sigma1256(x) { 
            return (S(x, 6) ^ S(x, 11) ^ S(x, 25))
        }
    
        function Gamma0256(x) { 
            return (S(x, 7) ^ S(x, 18) ^ R(x, 3))
        }
    
        function Gamma1256(x) { 
            return (S(x, 17) ^ S(x, 19) ^ R(x, 10))
        }
        
        function core_sha256 (m, l) {
            var K    = new Array(0x428A2F98, 0x71374491, 0xB5C0FBCF, 0xE9B5DBA5, 0x3956C25B, 0x59F111F1, 0x923F82A4, 0xAB1C5ED5, 0xD807AA98, 0x12835B01, 0x243185BE, 0x550C7DC3, 0x72BE5D74, 0x80DEB1FE, 0x9BDC06A7, 0xC19BF174, 0xE49B69C1, 0xEFBE4786, 0xFC19DC6, 0x240CA1CC, 0x2DE92C6F, 0x4A7484AA, 0x5CB0A9DC, 0x76F988DA, 0x983E5152, 0xA831C66D, 0xB00327C8, 0xBF597FC7, 0xC6E00BF3, 0xD5A79147, 0x6CA6351, 0x14292967, 0x27B70A85, 0x2E1B2138, 0x4D2C6DFC, 0x53380D13, 0x650A7354, 0x766A0ABB, 0x81C2C92E, 0x92722C85, 0xA2BFE8A1, 0xA81A664B, 0xC24B8B70, 0xC76C51A3, 0xD192E819, 0xD6990624, 0xF40E3585, 0x106AA070, 0x19A4C116, 0x1E376C08, 0x2748774C, 0x34B0BCB5, 0x391C0CB3, 0x4ED8AA4A, 0x5B9CCA4F, 0x682E6FF3, 0x748F82EE, 0x78A5636F, 0x84C87814, 0x8CC70208, 0x90BEFFFA, 0xA4506CEB, 0xBEF9A3F7, 0xC67178F2)
            var HASH = new Array(0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A, 0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19)
            var W    = new Array(64)
            var a, b, c, d, e, f, g, h, i, j
            var T1, T2
        
            m[l >> 5] |= 0x80 << (24 - l % 32)
            m[((l + 64 >> 9) << 4) + 15] = l
        
            for ( var i = 0; i < m.length; i+=16 ) {
                a = HASH[0]
                b = HASH[1]
                c = HASH[2]
                d = HASH[3]
                e = HASH[4]
                f = HASH[5]
                g = HASH[6]
                h = HASH[7]
            
                for ( var j = 0; j < 64; j++) {
                    if (j < 16)
                        W[j] = m[j + i]
                    else 
                        W[j] = safe_add(safe_add(safe_add(Gamma1256(W[j - 2]), W[j - 7]), Gamma0256(W[j - 15])), W[j - 16])
        
                    T1 = safe_add(safe_add(safe_add(safe_add(h, Sigma1256(e)), Ch(e, f, g)), K[j]), W[j])
                    T2 = safe_add(Sigma0256(a), Maj(a, b, c))
                
                    h = g
                    g = f
                    f = e
                    e = safe_add(d, T1)
                    d = c
                    c = b
                    b = a
                    a = safe_add(T1, T2)
                }
            
                HASH[0] = safe_add(a, HASH[0])
                HASH[1] = safe_add(b, HASH[1])
                HASH[2] = safe_add(c, HASH[2])
                HASH[3] = safe_add(d, HASH[3])
                HASH[4] = safe_add(e, HASH[4])
                HASH[5] = safe_add(f, HASH[5])
                HASH[6] = safe_add(g, HASH[6])
                HASH[7] = safe_add(h, HASH[7])
            }
    
            return HASH
        }
        
        function str2binb (str) {
            var bin = Array()
            var mask = (1 << chrsz) - 1
    
            for(var i = 0; i < str.length * chrsz; i += chrsz) {
                bin[i>>5] |= (str.charCodeAt(i / chrsz) & mask) << (24 - i % 32)
            }
    
            return bin
        }
        
        function Utf8Encode(string) {
            string = string.replace(/\r\n/g,'\n')
            var utftext = ''
        
            for (var n = 0; n < string.length; n++) {
                var c = string.charCodeAt(n)
            
                if (c < 128) {
                    utftext += String.fromCharCode(c)
                } else if((c > 127) && (c < 2048)) {
                    utftext += String.fromCharCode((c >> 6) | 192)
                    utftext += String.fromCharCode((c & 63) | 128)
                } else {
                    utftext += String.fromCharCode((c >> 12) | 224)
                    utftext += String.fromCharCode(((c >> 6) & 63) | 128)
                    utftext += String.fromCharCode((c & 63) | 128)
                }    
            }
        
            return utftext
        }
        
        function binb2hex (binarray) {
            var hex_tab = hexcase ? '0123456789ABCDEF' : '0123456789abcdef'
            var str = ''
    
            for(var i = 0; i < binarray.length * 4; i++) {
                str += hex_tab.charAt((binarray[i>>2] >> ((3 - i % 4)*8+4)) & 0xF) + hex_tab.charAt((binarray[i>>2] >> ((3 - i % 4)*8 )) & 0xF)
            }
    
            return str
        }
        
        s = Utf8Encode(s)
        return binb2hex(core_sha256(str2binb(s), s.length * chrsz))
    }
                    </pre>
                </code>
            </div>
        </div>
    </section>
    <!-- Bootstrap scripts -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
    <!-- Font Awesome Kit -->
    <script src="https://kit.fontawesome.com/19b86170ae.js"></script>
    <section class="container-fluid" style="background-color: black; color: white;">        
        <div class="spacer"></div>
        <div class="row">            
            <div class="col">
                <p class="text-left">Desarrollado por <a href="https://github.com/KBeDeveloper" target="_blank">Benjamín Calisto</a></p>
            </div>
            <div class="col">
                <p class="text-right"><span class="text-mutet">Potenciado por <a href="https://github.com/KBeDeveloper/SafeSoft-WebServices"><i class="fab fa-github" title="GitHub"></i></a></span></p>
                <div class="spacer-sm"></div>
            </div>
        </div>        
    </section>
</body>
</html>